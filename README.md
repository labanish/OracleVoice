# Oracle Digital Assistant Chat Custom Web App Readme (v. 19.1.3.0)

This chat allows you to host your bot on any website. You can also customize the look and feel of this widget.
## Requirements
NodeJS ([https://nodejs.org/en/](https://nodejs.org/en/))
## Bots SDK configuration
### Generate the App ID
1. In your Oracle Digital Assistant instance, open your bot, choose **Settings** in the left navbar, and then choose **Channels**.
1. Click **Add Channel** and then complete the dialog, choosing **Web** as the channel type. After you complete this dialog, Bots will generate the App Id that you need to initialize the Bots SDK. Keep it close at hand.
### Bots SDK
This sample app already has the Bots Client SDK for JavaScript included in the project. This SDK is compiled for the localhost environment only.
To use the SDK in another location, download it and  follow the readme file to compile it on your server.

### Configuration file
Required parameters for the SDK:
```json
{
  "mode": "botsSDK",
  "appId": "APPLICATION_ID",
  "sdkUrl": "SDK_FOLDER_URL"
}
```

## Running the sample
1. The sample applicationtemporaryas the Bots SDK included in the project.
1. Update samples configuration file in `chat-sample-custom-web\sample\settings.js` with details from the previous step.
1. Navigate to the `chat-sample-custom-web` directory.
1. Run `npm install`.
1. Run `npm start`.
1. In your browser, open `http://localhost:3001`.

## Developing
This sample comes with full source code. You can customize the widget look and feel by changing this code.
### Build the changes
1. Navigate to the `chat-sample-custom-web` directory.
1. Run `npm install`.
1. Run `npm run build`. This command will generate the file `dist\lib\bots-sdk-chat.js` that script can be used in any web application.

### Installing the compiled Widget
1. Create a configuration file and include this file to your page:
   ```html
   <script src="settings.js"></script>
   ```

1. Include the widget script to your page:
   ```html
   <script src="bots-sdk-chat.min.js"></script>
   ```

## Configuring the Widgets
The `settings.js` file can contain the following options:

#### Bots SDK connection mode
| Option | Type | Optional? | Description |
| --- |  --- | --- | --- |
| appId | String | No | App ID that was generated by Oracle Intelligent Bots. |
| sdkUrl | String | No | The URL to hosted Bots SDK. |

#### Other options

| Option | Type | Optional? | Default value | Description |
| --- |  --- | --- | --- | --- |
| isDebugMode | Boolean | Yes | false | Enables or disables logging. |
| chatTitle | String | Yes | Chat | The title of the chat window.  |
| chatSubTitle | String | Yes | We are here to help you | The subtitle of the chat window. |
| chatInputPlaceholder | String | Yes | Message | The chat window text input placeholder. |
| botIcon | String | Yes | Icon | The icon for the messages that come from the Bot. Base64 Image or Url |
| personIcon | String | Yes | Icon | The icon for the messages that sent by the user. Base64 Image or Url |
| sendIcon | String | Yes | Icon | The icon for the send message button. Base64 Image or Url |
| openIcon | String | Yes | Icon | The icon for the open chat button. Base64 Image or Url |
| logoIcon | String | Yes | None | The icon chat window header logo. Base64 Image or Url |
| useCustomStyle | Boolean | Yes | false | Enables or disables the build in styling. When the option is `true`, the widget does not add default style. The style should be created and added to the page manually. The example of the css file: `chat-sample-custom-web/assets/custom.css`|
| embeddedVideo | Boolean | Yes | true | Enable or disable video links embedding.|
| autoplayVideo | Boolean | Yes | false | Enable or disable video autoplay.|
| autoplayAudio | Boolean | Yes | false | Enable or disable audio autoplay.|
| webSocketReconnectInterval | Number | Yes | 1000 | The time in milliseconds to delay before attempting to reconnect.|
| webSocketTimeoutInterval | Number | Yes | 5000 | The time in milliseconds to wait for a connection to succeed before closing and retrying.|
| position | Object | Yes | {bottom: '20px',right: '20px'} | The position of the chat on the page.|

#### Position
| Option | Type | Description |
| --- |  --- | --- |
| left | String | The left position of the chat. This option can't be used in combination with `right` option. |
| right | String | The right position of the chat. This option can't be used in combination with `left` option. |
| bottom | String | The bottom position of the chat. This option can't be used in combination with `top` option. |
| top | String | The top position of the chat. This option can't be used in combination with `bottom` option. |

##### Example

```javascript
var chatWidgetWebSettings = {
    appId: '<YOUR_APP_ID>',
    sdkUrl: 'http://localhost:3001/bots-client-sdk-js',
    isDebugMode: false,
    chatTitle: 'Fix It Fast',
    chatSubTitle: 'We are here to help',
    chatInputPlaceholder: 'Please type the message...',
    botIcon: 'http://someurl.com/bot_icon.png',
    personIcon: 'http://someurl.com/person_icon.png',
    sendIcon: 'http://someurl.com/send_icon.png',
    openIcon: 'http://someurl.com/open_icon.png',
    logoIcon: 'http://someurl.com/logo_icon.png',
    useCustomStyle: false,
    embeddedVideo: true,
    autoplayVideo: false,
    autoplayAudio: false,
    webSocketReconnectInterval: 1000,
    webSocketTimeoutInterval: 5000,
    position: {
        left: '20px',
        bottom: '20px'
    }
};

```
## Demo
When the `isDebugMode` flag is switched on, the chat can process special text commands.
- `@clear` - clear the chat history (Create new user id and reload the page)
- `@demo` - Show all the messages types without interaction with server.

## Source Code
The project utilize Typescript as main language. 
#### Build process

1. Compile typescript to ES6 JavaScript
2. Concat component styles to one CSS file
3. Add prefix to all widget style classes to prevent conflicts
4. Minimize CSS file.
5. Add the CSS file content to style component
7. Convert ES6 to ES5 JavaScript
8. Concat all JavaScript files to one.

#### The project structure:
```text
chat-sample-custom-web 
├── assets // the project static assets like sample page with the widget.
├── build // the temporary folder created by build process
├── dist // the folder with files for deployment generated by build process
│   ├── lib // widget files
│   └── sample // sample with simple page and widget
└── src // source code
    ├── components // the components that creates HTML UI for the widget
    │   ├── chat // chat UI components
    │   │   ├── chat-footer // chat window footer that includes text input and the send button 
    │   │   └── messages // the components convert common message payload to HTML UI elements
    │   │       ├── actions // the components convert common message action payload to HTML UI elements
    │   │       ├── attachment-message // the components converts attachment common message to HTML UI elements
    │   │       │   └── attachments // the components per attachment type
    │   │       ├── card-message // the components convert horizontal/vertical cards list to HTML UI elements
    │   │       ├── loading-message // the component creates loading message in the chat UI
    │   │       ├── location-message // the component creates request location button and get location from the browser.
    │   │       ├── raw-message // the component displays JSON object as text message
    │   │       └── text-message // the component creates text message HTML UI from the common text message
    │   ├── loading // the component creates full chat window loading overlay
    │   ├── open-button // the component creates the open button HTM elements
    │   ├── shared // shared components
    │   │   ├── footer // the component creates a footer wrapper for the chat window
    │   │   ├── header // the component creates a header wrapper for the chat window
    │   │   ├── icon // the component creates icon HTML element
    │   │   └── icon-button // the component creates icon button
    │   ├── style // the component creates compiled widget style
    │   └── widget // the component creates the main wrapper for the widget
    ├── core // the core logic
    │   └── factories // the components factories
    ├── model // model for the widget
    │   ├── bots-sdk // bots sdk messages model
    │   │   └── messages // bots sdk messages
    │   │       └── actions // bots sdk messages actions
    │   └── common // common messages model
    │       └── payloads // common message payloads
    │           ├── action-payload // common action payloads
    │           └── message-payload // common message payloads
    └── providers // the providers for the widget
        ├── types // types for sdk library
        └── web-socket // reconnect web-socket

```


## License
Copyright (c) 2018, 2019  Oracle Corporation and contributors

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.