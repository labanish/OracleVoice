/**
* Copyright (c) 2019, Oracle and/or its affiliates. All rights reserved.
 * Oracle Chat Widget Web - Oracle bot chat client example, Release: 2.0.1
*/



!function(){function e(t,o,n){function r(i,s){if(!o[i]){if(!t[i]){var c="function"==typeof require&&require;if(!s&&c)return c(i,!0);if(a)return a(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var u=o[i]={exports:{}};t[i][0].call(u.exports,function(e){return r(t[i][1][e]||e)},u,u.exports,e,t,o,n)}return o[i].exports}for(var a="function"==typeof require&&require,i=0;i<n.length;i++)r(n[i]);return r}return e}()({1:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(){console.log("connecting to '"+A+"'"),(x=new WebSocket(A)).onopen=s,x.onmessage=l,x.onclose=c,x.onerror=u}function s(){console.log("connection to '"+A+"' open"),S=!1,navigator.getUserMedia}function c(e){console.log("connection to '"+A+"' closed: "+e)}function l(e){console.log("message received: '"+e.data+"'");var t=t=JSON.parse(e.data);if(null!=t&&null!=t.nbest&&"finalResult"===t.event){y.value=t.nbest[0].utterance;var o=t.nbest[0].utterance;null!=o&&k(o),setTimeout(function(){y.value=""},2e3)}else null!=t&&null!=t.nbest&&"partialResult"===t.event&&(console.log(t.nbest[0].utterance),y.value=t.nbest[0].utterance)}function u(){console.log("error connecting to '"+A+"'"),S=!0}function p(e,t,o){if(o===t)return e;if(o>t)throw new Error("downsampling rate show be smaller than original sample rate");for(var n=t/o,r=Math.round(e.length/n),a=new Int16Array(r),i=0,s=0;i<a.length;){for(var c=Math.round((i+1)*n),l=0,u=0,p=s;p<c&&p<e.length;p++)l+=e[p],u++;a[i]=32767*Math.min(1,l/u),i++,s=c}return a.buffer}function f(e){var t=p(e.inputBuffer.getChannelData(0),e.inputBuffer.sampleRate,16e3);1==x.readyState&&x.send(t)}function h(){1===x.readyState&&(console.log("sending done to asr service"),x.send("Done")),console.log("stopping microphone"),E.mediaStream.getAudioTracks().forEach(function(e){e.stop(),E.mediaStream.removeTrack(e)}),C.audioContext.close(),C.audioContext=null,O=!1}function d(e){i(),console.log("starting microphone"),C.audioContext=new AudioContext,E=C.audioContext.createMediaStreamSource(e),(T=C.audioContext.createScriptProcessor(P,1,1)).onaudioprocess=f,E.connect(T),T.connect(C.audioContext.destination),m(E,!0),O=!0}function m(e,t){var o={};o.source=e,o.context=o.source.context,o.fftSize=512,o.bufferLen=512,o.smoothingTimeConstant=.99,o.energy_offset=1e-8,o.energy_threshold_ratio_pos=2,o.energy_threshold_ratio_neg=.8,o.energy_integration=1,o.filter=[{f:200,v:0},{f:2e3,v:1}],o.hertzPerBin=o.context.sampleRate/o.fftSize,o.iterationFrequency=o.context.sampleRate/o.bufferLen,o.iterationPeriod=1/o.iterationFrequency,t&&console.log("Vad | sampleRate: "+o.context.sampleRate+" | hertzPerBin: "+o.hertzPerBin+" | iterationFrequency: "+o.iterationFrequency+" | iterationPeriod: "+o.iterationPeriod),o.setFilter=function(e){o.filter=[];for(var t=0,n=o.fftSize/2;t<n;t++){o.filter[t]=0;for(var r=0,a=e.length;r<a;r++)if(t*o.hertzPerBin<e[r].f){o.filter[t]=e[r].v;break}}},o.setFilter(o.filter),o.ready={},o.vadState=!1,o.energy_threshold_pos=o.energy_offset*o.energy_threshold_ratio_pos,o.energy_threshold_neg=o.energy_offset*o.energy_threshold_ratio_neg,o.voiceTrend=0,o.voiceTrendMax=10,o.voiceTrendMin=-10,o.voiceTrendStart=5,o.voiceTrendEnd=-5,o.analyser=o.context.createAnalyser(),o.analyser.smoothingTimeConstant=o.smoothingTimeConstant,o.analyser.fftSize=o.fftSize,o.floatFrequencyData=new Float32Array(o.analyser.frequencyBinCount),o.floatFrequencyDataLinear=new Float32Array(o.floatFrequencyData.length),o.source.connect(o.analyser),o.scriptProcessorNode=o.context.createScriptProcessor(o.bufferLen,1,1),o.scriptProcessorNode.connect(o.context.destination);var n=o;o.scriptProcessorNode.onaudioprocess=function(e){n.analyser.getFloatFrequencyData(n.floatFrequencyData),n.update(),n.monitor()},o.source.connect(o.scriptProcessorNode),o.update=function(){for(var e=o.floatFrequencyData,t=0,n=e.length;t<n;t++)o.floatFrequencyDataLinear[t]=Math.pow(10,e[t]/10);o.ready={}},o.getEnergy=function(){if(o.ready.energy)return o.energy;for(var e=0,t=o.floatFrequencyDataLinear,n=0,r=t.length;n<r;n++)e+=o.filter[n]*t[n]*t[n];return o.energy=e,o.ready.energy=!0,e},o.disconnect=function(){o.source.disconnect(o.scriptProcessorNode),o.source.disconnect(o.analyser),o.scriptProcessorNode.disconnect(o.context.destination)},o.monitor=function(){var e=o.getEnergy()-o.energy_offset;e>o.energy_threshold_pos?o.voiceTrend=o.voiceTrend+1>o.voiceTrendMax?o.voiceTrendMax:o.voiceTrend+1:e<-o.energy_threshold_neg?o.voiceTrend=o.voiceTrend-1<o.voiceTrendMin?o.voiceTrendMin:o.voiceTrend-1:o.voiceTrend>0?o.voiceTrend--:o.voiceTrend<0&&o.voiceTrend++;var t=!1,n=!1;o.voiceTrend>o.voiceTrendStart?t=!0:o.voiceTrend<o.voiceTrendEnd&&(n=!0);var r=e*o.iterationPeriod*o.energy_integration;return o.energy_offset+=r>0||!n?r:10*r,o.energy_offset=o.energy_offset<0?0:o.energy_offset,o.energy_threshold_pos=o.energy_offset*o.energy_threshold_ratio_pos,o.energy_threshold_neg=o.energy_offset*o.energy_threshold_ratio_neg,t&&!o.vadState&&(o.vadState=!0,console.log("start"),C.recording=!0),n&&o.vadState&&(o.vadState=!1,h(),console.log("stop")),e}}function b(e,t){k=t,navigator.getUserMedia?O?h():navigator.getUserMedia({audio:!0},function(e){d(e)},function(e){alert("Error capturing audio.")}):alert("getUserMedia not supported in this browser.")}Object.defineProperty(o,"__esModule",{value:!0}),o.ChatFooterComponent=void 0;var y,g=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),v=e("../../component"),w=e("../../shared/icon-button/icon-button.component"),_=e("../../shared/footer/footer.component"),O=!1,C=(o.ChatFooterComponent=function(e){function t(e,o,a,i,s){n(this,t);var c=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return c.onSend=o,c.sendButtonImgSrc=a,c.stopButtonImgSrc=i,c.inputPlaceholder=s,c.element=c._createElement(),y=c.input,window.onkeypress=function(e){console.log("onkeypress:"+e.key),"`"===e.key&&b(0,function(e){c.onSend(e)})},c}return a(t,v.Component),g(t,[{key:"render",value:function(e){e.appendChild(this.element)}},{key:"_createElement",value:function(){this.input=this.utils.createInput(["input"]),this.input.onkeypress=this.onInputKeyPress.bind(this),this.input.placeholder=this.inputPlaceholder,this.sendButton=new w.IconButtonComponent(this.utils,this.onClick.bind(this),this.sendButtonImgSrc),this.stopButton=new w.IconButtonComponent(this.utils,this.onClick.bind(this),this.stopButtonImgSrc);var e=new _.FooterComponent(this.utils);return e.appendContentChildElement(this.input),e.appendContentChild(this.sendButton),e.appendContentChild(this.stopButton),this.stopButton.hide(!0),e.element}},{key:"onInputKeyPress",value:function(e){"Enter"===e.key&&""!==this.input.value&&this._onSend()}},{key:"onClick",value:function(){var e=this;this.toggleButton(),b(0,function(t){console.log("In startButton callback"),e.sendButton.hide(!1),e.stopButton.hide(!0),""!==e.input.value&&e.onSend(t)})}},{key:"toggleButton",value:function(){O||(console.log("Toggle stop button off and start on"),this.sendButton.hide(!0),this.stopButton.hide(!1))}},{key:"_onSend",value:function(){this.onSend(this.input.value),this.input.value=""}}]),t}(),Window),k=null;C.recording=!1,C.audioContext=null;var P=16384,T=null,E=null,x=null,A="wss://speech-1.data.digitalassistant.oci.oc-test.com/v1/stream/recognize?culture=en-us&domain=generic&version=201909040000&partial=true&encoding=audio%2Fraw%3Brate%3D16000%3Bcoding%3Dlinear%3Bbyteorder%3DLE",S=!1;navigator.getUserMedia||(navigator.getUserMedia=navigator.getUserMedia)},{"../../component":21,"../../shared/footer/footer.component":25,"../../shared/icon-button/icon-button.component":27}],2:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(o,"__esModule",{value:!0}),o.ChatComponent=void 0;var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),s=function e(t,o,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,o);if(void 0===r){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,o,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},c=e("../component"),l=e("../shared/header/header.component"),u=e("./messages/message.component"),p=e("../../model/common/payloads/message-payload/message-payload.interface"),f=e("./messages/loading-message/loading-message.component"),h=e("../../model/common/payloads/action-payload/action-payload.interface"),d=e("../../model/common/message"),m=e("../../core/factories/message-component.factory"),b=e("../../core/logger"),y=e("./chat-footer/chat-footer.component"),g=e("../../providers/chat-actions");(o.ChatComponent=function(e){function t(e,o,a,i){n(this,t);var s=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s.settings=o,s.dataService=a,s.loadingComponent=i,s._logger=new b.Logger("ChatComponent"),s.element=s._createElement(),i.present("Please wait ..."),a.loadChat().then(function(e){setTimeout(function(){s.renderMessages(e.slice()),s.scrollToBottom(),i.dismiss(),a.onMessage=s.onMessageReceived.bind(s)})}),s.chatActions=new g.ChatActions(s.onMessageReceived.bind(s),s.onClear.bind(s)),s}return a(t,c.Component),i(t,[{key:"onClear",value:function(){this.dataService.clear()}},{key:"_createElement",value:function(){var e=this.utils.createDiv(["chat"]);return this.scrollContent=this.utils.createDiv(["scroll-content"]),this.scrollContent.id=t.MESSAGES_ID,e.appendChild(this.scrollContent),new y.ChatFooterComponent(this.utils,this.sendMessage.bind(this),this.settings.sendIcon,this.settings.stopIcon,this.settings.chatInputPlaceholder).appendToElement(e),new l.HeaderComponent(this.utils,this.settings.chatTitle,this.settings.chatSubTitle,"chat-title",null,null).prependToElement(e),e}},{key:"render",value:function(e){}},{key:"remove",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"remove",this).call(this),this.dataService.onMessage=function(){}}},{key:"renderMessages",value:function(e){var t=!0,o=!1,n=void 0;try{for(var r,a=e[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var i=r.value,s=m.MessageComponentFactory.fromMessage(this.utils,this.settings,i);s.onActionClick=this.onMessageActionClicked.bind(this),this.scrollContent.appendChild(s.render())}}catch(e){o=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(o)throw n}}}},{key:"onMessageActionClicked",value:function(e){var o=this;if(e.messageComponent.disableActions(),e.type===h.ACTION_TYPE.POST_BACK)e.getPayload().then(function(t){var n=(0,d.createUserMessage)({type:p.PAYLOAD_TYPE.POSTBACK,text:e.label,postback:t},o.settings.channel);o.sendMessageToServer(n)});else if(e.type===h.ACTION_TYPE.LOCATION){var n=document.getElementById(t.MESSAGES_ID),r=new f.LoadingMessageComponent("Loading location",u.MESSAGE_SIDE.RIGHT,this.utils);n.appendChild(r.render()),this.scrollToBottom(),e.getPayload().then(function(t){r.remove();var n=(0,d.createUserMessage)({type:p.PAYLOAD_TYPE.LOCATION,location:{title:"@Share Location"===e.label?"@demo location":void 0,longitude:t.longitude,latitude:t.latitude}},o.settings.channel);o.sendMessageToServer(n)})}}},{key:"onMessageReceived",value:function(e){this._logger.debug("onMessageReceived",e),this.renderMessages([e]),this.scrollToBottom()}},{key:"sendMessage",value:function(e){var t={type:p.PAYLOAD_TYPE.TEXT,text:e},o=(0,d.createUserMessage)(t,this.settings.channel);this.sendMessageToServer(o)}},{key:"sendMessageToServer",value:function(e){this.settings.isDebugMode&&this.chatActions.process(e)||this.dataService.send(e)}},{key:"scrollToBottom",value:function(){setTimeout(function(){var e=document.getElementById(t.MESSAGES_ID);e.scrollTop=e.scrollHeight-300})}}]),t}()).MESSAGES_ID="ochat_widget_messages"},{"../../core/factories/message-component.factory":32,"../../core/logger":33,"../../model/common/message":42,"../../model/common/payloads/action-payload/action-payload.interface":43,"../../model/common/payloads/message-payload/message-payload.interface":46,"../../providers/chat-actions":49,"../component":21,"../shared/header/header.component":26,"./chat-footer/chat-footer.component":1,"./messages/loading-message/loading-message.component":16,"./messages/message.component":18}],3:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(o,"__esModule",{value:!0});var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=function(){function e(t,o){n(this,e),this.utils=t,this.disabled=!1,this.type=o.type,this.label=o.label,this.imageUrl=o.imageUrl}return r(e,[{key:"render",value:function(){if(this.htmlElement=this.utils.createAnchor(),this.htmlElement.onclick=this.handleOnClick.bind(this),this.label)this.htmlElement.innerText=this.label;else{var e=this.utils.createImage(this.imageUrl);this.htmlElement.appendChild(e)}return this.htmlElement}},{key:"handleOnClick",value:function(e){if(this.onActionClick&&!this.disabled){var t={type:this.type,getPayload:this.getEventPayload.bind(this),label:this.label};this.onActionClick(t)}}},{key:"disable",value:function(){this.disabled=!0,this.htmlElement.classList.add(this.utils.getCssClassWithPrefix("disabled"))}}]),e}();o.ActionComponent=a},{}],4:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(o,"__esModule",{value:!0}),o.CallActionComponent=void 0;var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),s=function e(t,o,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,o);if(void 0===r){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,o,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},c=e("./action.component"),l=function(e){function t(e,o){n(this,t);var a=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,o));return a.phoneNumber=o.phoneNumber,a}return a(t,c.ActionComponent),i(t,[{key:"render",value:function(){var e=s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"render",this).call(this);return e.classList.add(this.utils.getCssClassWithPrefix("action-call")),e.href="tel:"+this.phoneNumber,e}},{key:"getEventPayload",value:function(){return Promise.resolve(this.phoneNumber)}}]),t}();o.CallActionComponent=l},{"./action.component":3}],5:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(o,"__esModule",{value:!0}),o.LocationActionComponent=void 0;var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),s=function e(t,o,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,o);if(void 0===r){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,o,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},c=e("./action.component"),l=function(e){function t(e,o){return n(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,o))}return a(t,c.ActionComponent),i(t,[{key:"render",value:function(){var e=s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"render",this).call(this);return e.classList.add(this.utils.getCssClassWithPrefix("action-location")),e}},{key:"getCurrentPosition",value:function(){return new Promise(function(e,t){navigator.geolocation.getCurrentPosition(function(t){e({latitude:t.coords.latitude,longitude:t.coords.longitude})},function(e){t(e)})})}},{key:"getEventPayload",value:function(){return this.getCurrentPosition()}}]),t}();o.LocationActionComponent=l},{"./action.component":3}],6:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(o,"__esModule",{value:!0}),o.PostbackActionComponent=void 0;var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),s=function e(t,o,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,o);if(void 0===r){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,o,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},c=e("./action.component"),l=function(e){function t(e,o){n(this,t);var a=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,o));return a.postback=o.postback,a}return a(t,c.ActionComponent),i(t,[{key:"render",value:function(){var e=s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"render",this).call(this);return e.classList.add(this.utils.getCssClassWithPrefix("action-postback")),e}},{key:"getEventPayload",value:function(){return Promise.resolve(this.postback)}}]),t}();o.PostbackActionComponent=l},{"./action.component":3}],7:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(o,"__esModule",{value:!0}),o.UrlActionComponent=void 0;var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),s=function e(t,o,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,o);if(void 0===r){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,o,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},c=e("./action.component"),l=function(e){function t(e,o){n(this,t);var a=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,o));return a.url=o.url,a}return a(t,c.ActionComponent),i(t,[{key:"render",value:function(){var e=s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"render",this).call(this);return e.classList.add(this.utils.getCssClassWithPrefix("action-url")),e.target="_blank",e.href=this.url,e}},{key:"getEventPayload",value:function(){return Promise.resolve(this.url)}}]),t}();o.UrlActionComponent=l},{"./action.component":3}],8:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(o,"__esModule",{value:!0}),o.AttachmentMessageComponent=void 0;var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),s=function e(t,o,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,o);if(void 0===r){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,o,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},c=e("../message.component"),l=e("../../../../model/common/payloads/attachment-payload.interface"),u=e("./attachments/image-attachment.component"),p=e("./attachments/video-attachment.component"),f=e("./attachments/audio-attachment.component"),h=e("./attachments/file-attachment.component"),d=function(e){function t(e,o,a,i){n(this,t);var s=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,o,a,i));return s.payload=a,s.attachment=t.fromPayload(e,o,a.attachment),s}return a(t,c.MessageComponent),i(t,[{key:"render",value:function(e){var o=this.utils.createDiv();return o.appendChild(s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"render",this).call(this)),o}},{key:"getContent",value:function(){return this.attachment.render()}}],[{key:"fromPayload",value:function(e,t,o){switch(o.type){case l.ATTACHMENT_TYPE.IMAGE:return new u.ImageAttachmentComponent(e,o);case l.ATTACHMENT_TYPE.VIDEO:return new p.VideoAttachmentComponent(e,t,o);case l.ATTACHMENT_TYPE.AUDIO:return new f.AudioAttachmentComponent(e,t,o);case l.ATTACHMENT_TYPE.FILE:return new h.FileAttachmentComponent(e,o);default:throw Error("Payload contains wrong attachment type")}}}]),t}();o.AttachmentMessageComponent=d},{"../../../../model/common/payloads/attachment-payload.interface":44,"../message.component":18,"./attachments/audio-attachment.component":10,"./attachments/file-attachment.component":11,"./attachments/image-attachment.component":12,"./attachments/video-attachment.component":13}],9:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(o,"__esModule",{value:!0});var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=function(){function e(t){n(this,e),this.title=e.capitalize(t.type)}return r(e,null,[{key:"capitalize",value:function(e){return e.charAt(0).toUpperCase()+e.slice(1)}}]),e}();o.AttachmentComponent=a},{}],10:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(o,"__esModule",{value:!0}),o.AudioAttachmentComponent=void 0;var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),s=e("./attachment.component"),c=function(e){function t(e,o,a){n(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,a));return i.utils=e,i.settings=o,i.url=a.url,i}return a(t,s.AttachmentComponent),i(t,[{key:"render",value:function(){var e=this.utils.createAudio(this.url,"attachment-audio",this.settings.autoplayAudio);return e.controls=!0,e.innerHTML='Your browser does not support embedded audio. However you can <a href="'+this.url+'">download it</a>.',e}}]),t}();o.AudioAttachmentComponent=c},{"./attachment.component":9}],11:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(o,"__esModule",{value:!0}),o.FileAttachmentComponent=void 0;var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),s=e("./attachment.component"),c=function(e){function t(e,o){n(this,t);var a=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,o));return a.utils=e,a.url=o.url,a}return a(t,s.AttachmentComponent),i(t,[{key:"render",value:function(){return this.utils.createAnchor(this.url,null,["attachment-file"])}}]),t}();o.FileAttachmentComponent=c},{"./attachment.component":9}],12:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(o,"__esModule",{value:!0}),o.ImageAttachmentComponent=void 0;var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),s=e("./attachment.component"),c=function(e){function t(e,o){n(this,t);var a=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,o));return a.utils=e,a.url=o.url,a}return a(t,s.AttachmentComponent),i(t,[{key:"render",value:function(){return this.utils.createImage(this.url,["attachment-image"])}}]),t}();o.ImageAttachmentComponent=c},{"./attachment.component":9}],13:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(o,"__esModule",{value:!0}),o.VideoAttachmentComponent=void 0;var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),s=e("./attachment.component"),c=function(e){function t(e,o,a){n(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,a));return i.utils=e,i.settings=o,i.url=a.url,i}return a(t,s.AttachmentComponent),i(t,[{key:"render",value:function(){var e=this.utils.createVideo(this.url,"attachment-video",this.settings.autoplayVideo);return e.controls=!0,e.innerHTML='Your browser does not support embedded video. However you can <a href="'+this.url+'">download it</a>.',e}}]),t}();o.VideoAttachmentComponent=c},{"./attachment.component":9}],14:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(o,"__esModule",{value:!0}),o.CardMessageComponent=void 0;var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),s=function e(t,o,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,o);if(void 0===r){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,o,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},c=e("../message.component"),l=e("./card.component"),u=function(e){function t(e,o,a,i){n(this,t);var s=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,o,a,i));s.cards=[],s.layout=a.layout;var c=!0,u=!1,p=void 0;try{for(var f,h=a.cards[Symbol.iterator]();!(c=(f=h.next()).done);c=!0){var d=f.value;s.cards.push(new l.CardComponent(s.utils,d))}}catch(e){u=!0,p=e}finally{try{!c&&h.return&&h.return()}finally{if(u)throw p}}return s}return a(t,c.MessageComponent),i(t,[{key:"render",value:function(){var e=this.utils.createDiv(["card-message","card-message-"+this.layout,this.side]),t=this.utils.createDiv(["card-message-content"]),o=this.utils.createDiv(["card-message-cards"]),n=!0,r=!1,a=void 0;try{for(var i,s=this.cards[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var c=i.value;c.onActionClick=this.handleOnActionClick.bind(this),o.appendChild(c.render())}}catch(e){r=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw a}}return o.appendChild(this.utils.createDiv(["clear"])),t.appendChild(o),e.appendChild(t),this.appendGlobalActions(e,this.actions),this.appendGlobalActions(e,this.globalActions),e}},{key:"disableActions",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disableActions",this).call(this);var e=!0,o=!1,n=void 0;try{for(var r,a=this.cards[Symbol.iterator]();!(e=(r=a.next()).done);e=!0)r.value.disableActions()}catch(e){o=!0,n=e}finally{try{!e&&a.return&&a.return()}finally{if(o)throw n}}}}]),t}();o.CardMessageComponent=u},{"../message.component":18,"./card.component":15}],15:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(o,"__esModule",{value:!0}),o.CardComponent=void 0;var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=e("../../../../core/factories/action-component.factory"),i=function(){function e(t,o){if(n(this,e),this.utils=t,this.actions=[],this.title=o.title,this.description=o.description,this.imageUrl=o.imageUrl,this.url=o.url,o.actions){var r=!0,i=!1,s=void 0;try{for(var c,l=o.actions[Symbol.iterator]();!(r=(c=l.next()).done);r=!0){var u=c.value,p=a.ActionComponentFactory.fromActionPayload(t,u);p&&(p.onActionClick=this.handleOnActionClick.bind(this),this.actions.push(p))}}catch(e){i=!0,s=e}finally{try{!r&&l.return&&l.return()}finally{if(i)throw s}}}}return r(e,[{key:"handleOnActionClick",value:function(e){this.onActionClick&&this.onActionClick(e)}},{key:"render",value:function(){var e=this.utils.createDiv(["card"]);this.imageUrl&&e.appendChild(this.utils.createImage(this.imageUrl));var t=this.utils.createDiv(["card-content"]),o=this.utils.createSpan(["card-title"]);o.innerText=this.title,t.appendChild(o);var n=this.utils.createParagraph();if(n.innerText=this.description,t.appendChild(n),e.appendChild(t),this.actions.length>0){var r=this.utils.createDiv(["card-actions"]),a=!0,i=!1,s=void 0;try{for(var c,l=this.actions[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var u=c.value;r.appendChild(u.render())}}catch(e){i=!0,s=e}finally{try{!a&&l.return&&l.return()}finally{if(i)throw s}}e.appendChild(r)}return e}},{key:"disableActions",value:function(){var e=!0,t=!1,o=void 0;try{for(var n,r=this.actions[Symbol.iterator]();!(e=(n=r.next()).done);e=!0)n.value.disable()}catch(e){t=!0,o=e}finally{try{!e&&r.return&&r.return()}finally{if(t)throw o}}}}]),e}();o.CardComponent=i},{"../../../../core/factories/action-component.factory":31}],16:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(o,"__esModule",{value:!0}),o.LoadingMessageComponent=void 0;var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=e("../../../loading/spinner.component"),i=function(){function e(t,o,r){n(this,e),this.text=t,this.side=o,this.utils=r}return r(e,[{key:"render",value:function(){this.element=this.utils.createDiv(["loading-message",this.side]);var e=this.utils.createDiv(["message-bubble"]),t=this.utils.createDiv(["message-content"]);t.appendChild(new a.SpinnerComponent(this.utils).render());var o=this.utils.createSpan();return o.innerText=this.text,t.appendChild(o),e.appendChild(t),this.element.appendChild(e),this.element.appendChild(this.utils.createDiv(["clear"])),this.element}},{key:"remove",value:function(){this.element.remove()}}]),e}();o.LoadingMessageComponent=i},{"../../../loading/spinner.component":23}],17:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(o,"__esModule",{value:!0}),o.LocationMessageComponent=void 0;var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),s=function e(t,o,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,o);if(void 0===r){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,o,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},c=e("../message.component"),l=e("../actions/url-action.component"),u=e("../../../../model/common/payloads/action-payload/action-payload.interface"),p=function(e){function t(e,o,a,i){n(this,t);var s=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,o,a,i));return s.title=a.location.title,s.url=a.location.url,s.longitude=a.location.longitude,s.latitude=a.location.latitude,s}return a(t,c.MessageComponent),i(t,[{key:"render",value:function(){if(0===this.actions.length){var e={type:u.ACTION_TYPE.URL,label:"Open Map",url:this.url||"https://www.google.com/maps?z=12&t=m&q=loc:"+this.latitude+"+"+this.longitude};this.actions.push(new l.UrlActionComponent(this.utils,e))}return s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"render",this).call(this)}},{key:"getContent",value:function(){var e=this.utils.createSpan();return this.title&&(e.innerText=this.title),e}}]),t}();o.LocationMessageComponent=p},{"../../../../model/common/payloads/action-payload/action-payload.interface":43,"../actions/url-action.component":7,"../message.component":18}],18:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(o,"__esModule",{value:!0}),o.MessageComponent=o.MESSAGE_SIDE=void 0;var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=e("../../../core/factories/action-component.factory"),i={RIGHT:"right",LEFT:"left"};o.MESSAGE_SIDE=i;var s=function(){function e(t,o,r,i){if(n(this,e),this.utils=t,this.settings=o,this.side=i,this.actions=[],this.globalActions=[],r.actions){var s=!0,c=!1,l=void 0;try{for(var u,p=r.actions[Symbol.iterator]();!(s=(u=p.next()).done);s=!0){var f=u.value,h=a.ActionComponentFactory.fromActionPayload(t,f);h&&(h.onActionClick=this.handleOnActionClick.bind(this),this.actions.push(h))}}catch(e){c=!0,l=e}finally{try{!s&&p.return&&p.return()}finally{if(c)throw l}}}if(r.globalActions){var d=!0,m=!1,b=void 0;try{for(var y,g=r.globalActions[Symbol.iterator]();!(d=(y=g.next()).done);d=!0){var v=y.value,w=a.ActionComponentFactory.fromActionPayload(t,v);w&&(w.onActionClick=this.handleOnActionClick.bind(this),this.globalActions.push(w))}}catch(e){m=!0,b=e}finally{try{!d&&g.return&&g.return()}finally{if(m)throw b}}}}return r(e,[{key:"render",value:function(e){var t=this.utils.createDiv(["message",this.side]),o=this.utils.createDiv(["message-wrapper"]);t.appendChild(o);var n=this.side===i.LEFT?this.settings.botIcon:this.settings.personIcon;n&&(o.classList.add(this.utils.getCssClassWithPrefix("has-profile-pic")),o.appendChild(this.utils.createImage(n,["message-profile-pic"])));var r=this.utils.createDiv(["message-bubble"]),a=this.utils.createDiv(["message-content"]);return a.appendChild(e||this.getContent()),r.appendChild(a),this.actions&&this.appendActions(r,this.actions),o.appendChild(r),o.appendChild(this.utils.createDiv(["clear"])),this.globalActions&&this.appendGlobalActions(t,this.globalActions),t.appendChild(this.utils.createDiv(["clear"])),t}},{key:"getContent",value:function(){throw new Error("Method not implemented.")}},{key:"disableActions",value:function(){var e=!0,t=!1,o=void 0;try{for(var n,r=this.actions[Symbol.iterator]();!(e=(n=r.next()).done);e=!0)n.value.disable()}catch(e){t=!0,o=e}finally{try{!e&&r.return&&r.return()}finally{if(t)throw o}}var a=!0,i=!1,s=void 0;try{for(var c,l=this.globalActions[Symbol.iterator]();!(a=(c=l.next()).done);a=!0)c.value.disable()}catch(e){i=!0,s=e}finally{try{!a&&l.return&&l.return()}finally{if(i)throw s}}}},{key:"handleOnActionClick",value:function(e){if(this.onActionClick){var t=e;t.messageComponent=this,this.onActionClick(t)}}},{key:"appendActions",value:function(e,t){if(t.length>0){var o=this.utils.createDiv(["message-actions"]),n=!0,r=!1,a=void 0;try{for(var i,s=t[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var c=i.value;o.appendChild(c.render())}}catch(e){r=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw a}}e.appendChild(o)}}},{key:"appendGlobalActions",value:function(e,t){if(t.length>0){var o=this.utils.createDiv(["message-global-actions"]),n=!0,r=!1,a=void 0;try{for(var i,s=t[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var c=i.value;o.appendChild(c.render())}}catch(e){r=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw a}}e.appendChild(o)}}}]),e}();o.MessageComponent=s},{"../../../core/factories/action-component.factory":31}],19:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(o,"__esModule",{value:!0}),o.RawMessageComponent=void 0;var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),s=e("../message.component"),c=function(e){function t(e,o,a,i){n(this,t);var s=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,o,a,i));return s.payload=JSON.stringify(a.payload),s}return a(t,s.MessageComponent),i(t,[{key:"getContent",value:function(){var e=this.utils.createSpan();return e.innerText=this.payload,e}}]),t}();o.RawMessageComponent=c},{"../message.component":18}],20:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(o,"__esModule",{value:!0}),o.TextMessageComponent=void 0;var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),s=e("../message.component"),c=function(e){function t(e,o,a,i){n(this,t);var s=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,o,a,i));return s.text=a.text,s}return a(t,s.MessageComponent),i(t,[{key:"getContent",value:function(){var e=this.utils.createSpan();if(e.innerHTML=this.utils.linkify(this.text,this.settings.embeddedVideo),"left"===this.side){var t=new SpeechSynthesisUtterance(this.text);window.speechSynthesis.speak(t),console.log(this.side)}return e}}]),t}();o.TextMessageComponent=c},{"../message.component":18}],21:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(o,"__esModule",{value:!0});var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=function(){function e(t){n(this,e),this.utils=t}return r(e,[{key:"addClass",value:function(e){this.element.classList.add(this.utils.getCssClassWithPrefix(e))}},{key:"hide",value:function(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0]?(this.orgDisplayStyle=this.element.style.display,this.element.style.display="none"):this.element.style.display=this.orgDisplayStyle}},{key:"remove",value:function(){this.element.remove()}},{key:"appendToElement",value:function(e){e.appendChild(this.element)}},{key:"prependToElement",value:function(e){var t=e.firstChild;t?e.insertBefore(this.element,t):e.appendChild(this.element)}},{key:"appendContentChildElement",value:function(e){this.getContentElement().appendChild(e)}},{key:"appendContentChild",value:function(e){this.getContentElement().appendChild(e.element)}},{key:"getContentElement",value:function(){return this.element}}]),e}();o.Component=a},{}],22:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(o,"__esModule",{value:!0}),o.LoadingComponent=void 0;var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),s=e("../component"),c=e("./spinner.component");o.LoadingComponent=function(e){function t(e){n(this,t);var o=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.element=o._createElement(),o.hide(),o}return a(t,s.Component),i(t,[{key:"render",value:function(e){}},{key:"_createElement",value:function(){var e=this.utils.createDiv(["loading"]);e.appendChild(this.utils.createDiv(["backdrop"]));var t=e.appendChild(this.utils.createDiv(["wrapper"]));return t.appendChild(new c.SpinnerComponent(this.utils).render()),this.content=t.appendChild(this.utils.createDiv(["content"])),e}},{key:"present",value:function(e){this.hide(!1),this.setContent(e)}},{key:"dismiss",value:function(){this.hide(),this.setContent("")}},{key:"getContentElement",value:function(){return this.element}},{key:"setContent",value:function(e){this.content.innerHTML=e}}]),t}()},{"../component":21,"./spinner.component":23}],23:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(o,"__esModule",{value:!0});var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=function(){function e(t){n(this,e),this.utils=t}return r(e,[{key:"render",value:function(){var e=this.utils.createDiv(["spinner"]);return e.innerHTML='<svg viewBox="0 0 64 64"><circle transform="translate(32,32)" r="26"></circle></svg>',e}}]),e}();o.SpinnerComponent=a},{}],24:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(o,"__esModule",{value:!0}),o.OpenButtonComponent=void 0;var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),s=e("../component"),c=e("../shared/icon-button/icon-button.component");o.OpenButtonComponent=function(e){function t(e,o,a){n(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.settings=o,i.onOpen=a,i.element=i._createElement(),i}return a(t,s.Component),i(t,[{key:"render",value:function(e){e.appendChild(this.element)}},{key:"_createElement",value:function(){return new c.IconButtonComponent(this.utils,this.onOpen.bind(this),this.settings.openIcon,"chat-button").element}}]),t}()},{"../component":21,"../shared/icon-button/icon-button.component":27}],25:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(o,"__esModule",{value:!0}),o.FooterComponent=void 0;var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),s=e("../../component");o.FooterComponent=function(e){function t(e,o){n(this,t);var a=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.className=o,a.element=a._createElement(),a}return a(t,s.Component),i(t,[{key:"render",value:function(e){e.appendChild(this.element)}},{key:"_createElement",value:function(){var e=this.utils.createDiv(["footer"]),t=this.utils.createDiv(["toolbar"]);return this.content=t,e.appendChild(t),e}},{key:"getContentElement",value:function(){return this.content}}]),t}()},{"../../component":21}],26:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(o,"__esModule",{value:!0}),o.HeaderComponent=void 0;var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),s=e("../../component");o.HeaderComponent=function(e){function t(e,o){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;n(this,t);var l=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return l.title=o,l.subTitle=a,l.className=i,l.rightButton=s,l.leftButton=c,l.element=l._createElement(),l}return a(t,s.Component),i(t,[{key:"render",value:function(e){e.appendChild(this.element)}},{key:"_createElement",value:function(){var e=this.utils.createDiv(["header",this.className]);this.leftButton&&(this.leftButton.addClass("left"),e.appendChild(this.leftButton.element));var t=this.utils.createSpan(["header-title"]);if(t.innerText=this.title,e.appendChild(t),this.subTitle){var o=this.utils.createSpan(["header-sub-title"]);o.innerText=this.subTitle,e.appendChild(o)}return this.rightButton&&(this.rightButton.addClass("right"),e.appendChild(this.rightButton.element)),e}}]),t}()},{"../../component":21}],27:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(o,"__esModule",{value:!0}),o.IconButtonComponent=void 0;var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),s=e("../../component"),c=e("../icon/icon.component");o.IconButtonComponent=function(e){function t(e,o,a){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";n(this,t);var s=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s.onClick=o,s.imgSrc=a,s.className=i,s.element=s._createElement(),s}return a(t,s.Component),i(t,[{key:"render",value:function(e){e.appendChild(this.element)}},{key:"_createElement",value:function(){var e=this,t=this.utils.createButton(["button","icon-button",this.className]);t.onclick=function(){return e.onClick(t.innerText)};var o=new c.IconComponent(this.utils,this.imgSrc);return t.appendChild(o.element),t}}]),t}()},{"../../component":21,"../icon/icon.component":28}],28:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(o,"__esModule",{value:!0}),o.IconComponent=void 0;var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),s=e("../../component");o.IconComponent=function(e){function t(e,o){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";n(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.imgSrc=o,i.className=a,i.element=i._createElement(),i}return a(t,s.Component),i(t,[{key:"render",value:function(e){e.appendChild(this.element)}},{key:"_createElement",value:function(){var e=document.createElement("i");return this.className&&e.classList.add(this.utils.getCssClassWithPrefix(this.className)),e.classList.add(this.utils.getCssClassWithPrefix("icon")),e.style.backgroundImage="url('"+this.imgSrc+"')",e}}]),t}()},{"../../component":21}],29:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(o,"__esModule",{value:!0});var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=function(){function e(t){n(this,e),this.utils=t}return r(e,[{key:"render",value:function(){return this.utils.createStyle(e.STYLE)}}]),e}();a.STYLE='@keyframes shadow-pulse{0%{box-shadow:0 0 0 0 rgba(255,0,0,.2)}100%{box-shadow:0 0 0 10px rgba(255,0,0,0)}}.chat-sample-custom-web-chat .chat-sample-custom-web-input{-moz-appearance:none;-ms-appearance:none;-webkit-appearance:none;margin:6px;appearance:none;display:block;width:100%;border:0;font-family:inherit;height:auto;font-weight:400;line-height:3rem;color:#403c38;background:transparent 8px center;border-bottom:1px solid #403c38}.chat-sample-custom-web-chat .chat-sample-custom-web-input:focus{border-bottom:1px solid #403c38;-webkit-box-shadow:0 1px 0 0 #403c38;box-shadow:0 1px 0 0 #403c38}.chat-sample-custom-web-chat .chat-sample-custom-web-toolbar .chat-sample-custom-web-button{background:0 0;border:none!important;font-size:0;box-shadow:none;box-sizing:content-box;display:block;width:35px;height:35px;padding:2px;cursor:pointer;position:absolute;right:3px;top:6px}.chat-sample-custom-web-chat .chat-sample-custom-web-toolbar .chat-sample-custom-web-icon-button{vertical-align:middle}.chat-sample-custom-web-chat{position:absolute;color:#000;bottom:10px;right:80px;display:block;width:350px;height:450px;contain:layout size style;transform:scale(0)}.chat-sample-custom-web-chat .chat-sample-custom-web-scroll-content{background-image:url(/chatbg.png);background-size:400px 400px;background-repeat:repeat;-webkit-box-shadow:0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12),0 3px 1px -2px rgba(0,0,0,.2);box-shadow:0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12),0 3px 1px -2px rgba(0,0,0,.2);margin-top:50px;position:absolute;top:0;right:0;bottom:0;left:0;z-index:1;display:block;contain:size style layout;height:348px;overflow-x:hidden;overflow-y:scroll;-webkit-overflow-scrolling:auto;will-change:initial}.chat-sample-custom-web-open .chat-sample-custom-web-chat{animation:bouncein .4s ease-out forwards .2s;transform:scale(0)}.chat-sample-custom-web-close .chat-sample-custom-web-chat{transform:scale(1);animation:bounceout .25s ease-out forwards .2s}@keyframes bouncein{0%{transform:scale(0)}60%{transform:scale(1.1)}100%{transform:scale(1)}}@keyframes bounceout{0%{transform:scale(1)}40%{transform:scale(1.1)}100%{transform:scale(0)}}.chat-sample-custom-web-card-actions{border-top:1px solid #e6e5eb}.chat-sample-custom-web-card-actions,.chat-sample-custom-web-message-actions{background-color:#fff;margin:10px -17px -9px;z-index:2;position:relative;border-radius:0 0 23px 1px}.chat-sample-custom-web-card-actions a,.chat-sample-custom-web-message-actions a{border-bottom:1px solid #e6e5eb;display:block;text-decoration:none;color:#000;cursor:pointer;padding:12px}.chat-sample-custom-web-right .chat-sample-custom-web-message-actions a{border-bottom-color:#158ffe}.chat-sample-custom-web-card-actions a:hover,.chat-sample-custom-web-message-actions a:hover{text-decoration:none}.chat-sample-custom-web-card-actions a:last-child,.chat-sample-custom-web-message-actions a:last-child{border-bottom:0;margin-bottom:0;border-radius:0 0 23px 1px}.chat-sample-custom-web-message .chat-sample-custom-web-message-global-actions{margin:7px}.chat-sample-custom-web-message-global-actions a{display:inline-block;border:1px solid #e6e5eb;border-radius:4px;margin:.4rem .2rem;padding:1px 13px;text-decoration:none;color:#000;cursor:pointer}.chat-sample-custom-web-card-actions a.chat-sample-custom-web-disabled,.chat-sample-custom-web-message-actions a.chat-sample-custom-web-disabled,.chat-sample-custom-web-message-global-actions a.chat-sample-custom-web-disabled{cursor:default;background-color:#f8f8f8;pointer-events:none}.chat-sample-custom-web-attachment-image,.chat-sample-custom-web-attachment-video{width:100%}.chat-sample-custom-web-attachment-file{word-break:break-all}.chat-sample-custom-web-attachment-audio{width:190px}.chat-sample-custom-web-card{margin:10px 10px 10px 10px;width:calc(100% - 20px);border-radius:2px;background:#fff;box-shadow:0 2px 2px 0 rgba(0,0,0,.14),0 3px 1px -2px rgba(0,0,0,.2),0 1px 5px 0 rgba(0,0,0,.12);display:block;overflow:hidden;padding:13px 16px 13px 16px}.chat-sample-custom-web-card img{width:100%}.chat-sample-custom-web-card-message-horizontal .chat-sample-custom-web-card-message-cards{overflow-x:scroll;white-space:nowrap}.chat-sample-custom-web-card-message-horizontal .chat-sample-custom-web-card{width:266px;display:inline-block}.chat-sample-custom-web-message{position:relative}.chat-sample-custom-web-attachment-image,.chat-sample-custom-web-attachment-video{width:100%}.chat-sample-custom-web-attachment-file{word-break:break-all}.chat-sample-custom-web-attachment-audio{width:190px}.chat-sample-custom-web-message-bubble{border-radius:24px;display:inline-block;padding:10px 18px;position:relative;margin:10px;max-width:80%;box-shadow:0 2px 16px 0 rgba(33,31,28,.24)}.chat-sample-custom-web-message-bubble:before{content:"";display:block;height:16px;width:9px;position:absolute;bottom:-7.5px;z-index:1}.chat-sample-custom-web-message-content{overflow:hidden;word-wrap:break-word}.chat-sample-custom-web-left .chat-sample-custom-web-message-bubble{background-color:#57504a;color:#fff;float:left;border-bottom-left-radius:0}.chat-sample-custom-web-left .chat-sample-custom-web-has-profile-pic .chat-sample-custom-web-message-bubble{margin-left:40px}.chat-sample-custom-web-right .chat-sample-custom-web-message-bubble{background-color:#fff;color:#000;float:right;border-bottom-right-radius:0}.chat-sample-custom-web-right .chat-sample-custom-web-has-profile-pic .chat-sample-custom-web-message-bubble{margin-right:40px}.chat-sample-custom-web-message-profile-pic{display:inline-block;width:25px;height:25px;border-radius:50%;position:absolute;bottom:6px;background-color:rgba(20,0,0,.12)}.chat-sample-custom-web-left .chat-sample-custom-web-message-profile-pic{left:10px}.chat-sample-custom-web-right .chat-sample-custom-web-message-profile-pic{right:10px}.chat-sample-custom-web-message-wrapper{position:relative}.chat-sample-custom-web-loading{display:none;z-index:10001;position:absolute;top:0;right:0;bottom:0;left:0;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;contain:strict}.chat-sample-custom-web-loading .chat-sample-custom-web-backdrop{opacity:.5;position:absolute;top:0;left:0;z-index:2;display:block;width:100%;height:100%;background-color:#000;-webkit-transform:translateZ(0);transform:translateZ(0)}.chat-sample-custom-web-loading .chat-sample-custom-web-wrapper{padding:15px 10px 15px 15px;max-width:280px;max-height:90%;border-radius:2px;color:rgba(0,0,0,.5);background:#fafafa;box-shadow:0 16px 20px rgba(0,0,0,.4);z-index:10;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-ms-flex-align:center;align-items:center}.chat-sample-custom-web-spinner{position:relative;display:inline-block;width:28px;height:28px;margin-right:5px}.chat-sample-custom-web-spinner svg{animation-duration:750ms;-webkit-animation:spinner-rotate 1s linear infinite;animation:spinner-rotate 1s linear infinite;overflow:hidden;position:absolute;top:0;left:0;width:100%;height:100%;-webkit-transform:translateZ(0);transform:translateZ(0)}.chat-sample-custom-web-spinner circle{stroke:#387ef5;fill:transparent;stroke-width:4px;stroke-dasharray:128px;stroke-dashoffset:82px}@-webkit-keyframes spinner-rotate{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spinner-rotate{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.chat-sample-custom-web-chat-button{box-sizing:border-box;display:block;position:absolute;width:65px;height:65px;padding:0;cursor:pointer;bottom:0;right:0;background:0 0;border:none!important;font-size:0;box-shadow:none}.chat-sample-custom-web-chat-button.chat-sample-custom-web-button:hover,.chat-sample-custom-web-open .chat-sample-custom-web-chat-button.chat-sample-custom-web-button{transform:scale(1.05)}.chat-sample-custom-web-chat-button.chat-sample-custom-web-button i{background:no-repeat center center;border:2px solid #fff;background-size:100%;width:100%;height:100%;border-radius:50%;-webkit-align-self:stretch;align-self:stretch;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center;display:-webkit-flex;display:flex}.chat-sample-custom-web-footer{position:absolute;bottom:0;left:0;z-index:10;display:block;width:100%;box-shadow:0 -4px 10px 0 rgba(0,0,0,.1)}.chat-sample-custom-web-footer .chat-sample-custom-web-toolbar{color:rgba(0,0,0,.87);background-color:#fff;box-sizing:border-box;-webkit-tap-highlight-color:transparent;height:52px;position:relative;padding:3px 50px 3px 3px;border-radius:0 0 6px 6px}.chat-sample-custom-web-header{background-image:url(/headerbg.png);border-radius:6px 6px 0 0;position:absolute;top:0;left:0;z-index:10;display:block;width:100%;background:#57504a;height:50px;padding:3px;-webkit-box-shadow:0 2px 8px 0 rgba(0,0,0,.11);box-shadow:0 2px 8px 0 rgba(0,0,0,.11)}.chat-sample-custom-web-header .chat-sample-custom-web-avatar{position:absolute;display:block;background:rgba(20,0,0,.12) no-repeat center center;background-size:80%;width:40px;height:40px;border-radius:50%;-webkit-align-self:stretch;align-self:stretch;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center;top:4px;left:4px}.chat-sample-custom-web-header-title{padding:0 12px;font-weight:500;color:#fff;display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;text-align:center;font-size:16px}.chat-sample-custom-web-header-sub-title{color:#fff;text-align:center;display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.chat-sample-custom-web-header .chat-sample-custom-web-button{top:8px;position:absolute;border-radius:50%;box-sizing:border-box;display:block;width:35px;height:35px;padding:2px;cursor:pointer}.chat-sample-custom-web-header .chat-sample-custom-web-button.chat-sample-custom-web-right{right:3px}.chat-sample-custom-web-header .chat-sample-custom-web-button .chat-sample-custom-web-icon{background-size:15px;width:15px;height:15px}.chat-sample-custom-web-icon{padding:0;pointer-events:none;display:inline-block;background-size:20px 20px;width:20px;height:20px;vertical-align:middle}.chat-sample-custom-web-button:active,.chat-sample-custom-web-button:focus,.chat-sample-custom-web-input:active,.chat-sample-custom-web-input:focus{outline:0}.chat-sample-custom-web-clear{clear:both}.chat-sample-custom-web-widget{font-family:"Oracle Sans","Helvetica Neue",sans-serif;font-size:13px;position:fixed;z-index:10;display:block;width:350px;height:450px}',o.StyleComponent=a},{}],30:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(o,"__esModule",{value:!0}),o.WidgetComponent=void 0;var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),s=e("../component"),c=e("../loading/loading.component"),l=e("../chat/chat.component"),u=e("../open-button/open-button.component");o.WidgetComponent=function(e){function t(e,o,a){n(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.settings=o,i.dataService=a,i.isOpen=!1,i.element=i._createElement(),i}return a(t,s.Component),i(t,[{key:"render",value:function(e){}},{key:"_createElement",value:function(){var e=this,t=this.utils.createDiv(["widget"]);return this.settings.position.bottom&&(t.style.bottom=this.settings.position.bottom),this.settings.position.left&&(t.style.left=this.settings.position.left),this.settings.position.top&&(t.style.top=this.settings.position.top),this.settings.position.right&&(t.style.right=this.settings.position.right),this.loadingComponent=new c.LoadingComponent(this.utils),t.appendChild(this.loadingComponent.element),this.chatButtonComponent=new u.OpenButtonComponent(this.utils,this.settings,function(){return e.showChat()}),t.appendChild(this.chatButtonComponent.element),this.chatComponent=new l.ChatComponent(this.utils,this.settings,this.dataService,this.loadingComponent),t.appendChild(this.chatComponent.element),t}},{key:"showChat",value:function(){this.isOpen=!this.isOpen,this.isOpen?(this.element.classList.add(this.utils.getCssClassWithPrefix("open")),this.element.classList.remove(this.utils.getCssClassWithPrefix("close"))):(this.element.classList.add(this.utils.getCssClassWithPrefix("close")),this.element.classList.remove(this.utils.getCssClassWithPrefix("open")))}}]),t}()},{"../chat/chat.component":2,"../component":21,"../loading/loading.component":22,"../open-button/open-button.component":24}],31:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(o,"__esModule",{value:!0}),o.ActionComponentFactory=void 0;var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=e("../../model/common/payloads/action-payload/action-payload.interface"),i=e("../../components/chat/messages/actions/postback-action.component"),s=e("../../components/chat/messages/actions/call-action.component"),c=e("../../components/chat/messages/actions/location-action.component"),l=e("../../components/chat/messages/actions/url-action.component"),u=e("../logger"),p=function(){function e(){n(this,e)}return r(e,null,[{key:"fromActionPayload",value:function(t,o){switch(o.type){case a.ACTION_TYPE.POST_BACK:return new i.PostbackActionComponent(t,o);case a.ACTION_TYPE.CALL:return new s.CallActionComponent(t,o);case a.ACTION_TYPE.LOCATION:return new c.LocationActionComponent(t,o);case a.ACTION_TYPE.URL:return new l.UrlActionComponent(t,o);default:return e.logger.error("Payload contains wrong action type:"+o.type),null}}}]),e}();p.logger=new u.Logger("ActionComponentFactory"),o.ActionComponentFactory=p},{"../../components/chat/messages/actions/call-action.component":4,"../../components/chat/messages/actions/location-action.component":5,"../../components/chat/messages/actions/postback-action.component":6,"../../components/chat/messages/actions/url-action.component":7,"../../model/common/payloads/action-payload/action-payload.interface":43,"../logger":33}],32:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(o,"__esModule",{value:!0}),o.MessageComponentFactory=void 0;var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=e("../../model/common/payloads/message-payload/message-payload.interface"),i=e("../../components/chat/messages/message.component"),s=e("../../components/chat/messages/text-message/text-message.component"),c=e("../../components/chat/messages/attachment-message/attachment-message.component"),l=e("../../components/chat/messages/card-message/card-message.component"),u=e("../../components/chat/messages/location-message/location-message.component"),p=e("../../components/chat/messages/raw-message/raw-message.component"),f=function(){function e(){n(this,e)}return r(e,null,[{key:"fromMessage",value:function(e,t,o){var n=void 0,r=void 0;switch(o.from?(n=i.MESSAGE_SIDE.LEFT,r=o.body.messagePayload):(n=i.MESSAGE_SIDE.RIGHT,r=o.messagePayload),r.type){case a.PAYLOAD_TYPE.TEXT:return new s.TextMessageComponent(e,t,r,n);case a.PAYLOAD_TYPE.ATTACHMENT:return new c.AttachmentMessageComponent(e,t,r,n);case a.PAYLOAD_TYPE.CARD:return new l.CardMessageComponent(e,t,r,n);case a.PAYLOAD_TYPE.LOCATION:return new u.LocationMessageComponent(e,t,r,n);case a.PAYLOAD_TYPE.RAW:return new p.RawMessageComponent(e,t,r,n);default:throw Error("Wrong message payload type:"+r.type)}}}]),e}();o.MessageComponentFactory=f},{"../../components/chat/messages/attachment-message/attachment-message.component":8,"../../components/chat/messages/card-message/card-message.component":14,"../../components/chat/messages/location-message/location-message.component":17,"../../components/chat/messages/message.component":18,"../../components/chat/messages/raw-message/raw-message.component":19,"../../components/chat/messages/text-message/text-message.component":20,"../../model/common/payloads/message-payload/message-payload.interface":46}],33:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(o,"__esModule",{value:!0});var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o.Logger=function(){function e(t){n(this,e),this.module=t}return r(e,[{key:"debug",value:function(){for(var t=arguments.length,o=Array(t),n=0;n<t;n++)o[n]=arguments[n];this.log(e.LOG_LEVEL.DEBUG,o)}},{key:"error",value:function(){for(var t=arguments.length,o=Array(t),n=0;n<t;n++)o[n]=arguments[n];this.log(e.LOG_LEVEL.ERROR,o)}},{key:"info",value:function(){for(var t=arguments.length,o=Array(t),n=0;n<t;n++)o[n]=arguments[n];this.log(e.LOG_LEVEL.INFO,o)}},{key:"warn",value:function(){for(var t=arguments.length,o=Array(t),n=0;n<t;n++)o[n]=arguments[n];this.log(e.LOG_LEVEL.WARN,o)}},{key:"log",value:function(t,o){if(e.logLevel>=t){o.unshift("["+e.appName+"."+e.appVersion+"."+this.module+"]");var n=void 0;switch(e.logLevel){case e.LOG_LEVEL.ERROR:n=console.error;break;case e.LOG_LEVEL.WARN:n=console.warn;break;case e.LOG_LEVEL.INFO:n=console.info;break;case e.LOG_LEVEL.DEBUG:n=console.debug}e.historyEnabled&&(e.history.push(Object.assign({},o,{level:t})),e.historySize<=e.history.length&&e.history.shift()),n.apply(console,o)}}}]),e}();a.LOG_LEVEL={NONE:0,ERROR:1,WARN:2,INFO:3,DEBUG:4},a.logLevel=a.LOG_LEVEL.ERROR,a.historyEnabled=!1,a.historySize=100,a.history=[]},{}],34:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n={CHAT_SERVER:"chatServer",BOTS_SDK:"botsSDK"};o.MODE=n;o.defaultSettings={version:"2.0.1",name:"chat-sample-custom-web",mode:n.BOTS_SDK,isDebugMode:!1,webSocketReconnectInterval:1e3,webSocketTimeoutInterval:5e3,autoplayVideo:!1,autoplayAudio:!1,chatTitle:"Oracle Bots Chat Widget",chatSubTitle:"How can we help?",chatInputPlaceholder:"Type a message...",position:{bottom:"20px",right:"20px"},useCustomStyle:!1,embeddedVideo:!0,isOpen:!1,embedded:!1,openIcon:"askoracle.svg",sendIcon:"microphone-solid.svg",stopIcon:"stop-circle-regular.svg"}},{}],35:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(o,"__esModule",{value:!0});var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=function(){function e(t){n(this,e),this.settings=t}return r(e,[{key:"clone",value:function(e){return JSON.parse(JSON.stringify(e))}},{key:"linkify",value:function(e,t){var o=this,n=void 0,r=void 0,a=void 0;return r=/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim,n=e.replace(r,function(e,n,r){var a=t?o.getYouTubeVideoId(n):null;return a?'<iframe width="100%" src="https://www.youtube.com/embed/'+a+'" frameborder="0" allowfullscreen></iframe>':'<a href="'+n+'" target="_blank">'+n+"</a>"}),a=/(^|[^\/])(www\.[\S]+(\b|$))/gim,n=n.replace(a,function(e,n,r){var a=t?o.getYouTubeVideoId("http://"+r):null;return a?'<iframe width="100%" src="https://www.youtube.com/embed/'+a+'" frameborder="0" allowfullscreen></iframe>':n+'<a href="http://'+r+'" target="_blank">'+r+"</a>"})}},{key:"getYouTubeVideoId",value:function(e){var t=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/,o=e.match(t);return o&&11==o[2].length?o[2]:null}},{key:"getCssClassWithPrefix",value:function(e){return this.settings.name+"-"+e}},{key:"createButton",value:function(e){var t=document.createElement("button");if(e){var o=!0,n=!1,r=void 0;try{for(var a,i=e[Symbol.iterator]();!(o=(a=i.next()).done);o=!0){var s=a.value;t.classList.add(this.getCssClassWithPrefix(s))}}catch(e){n=!0,r=e}finally{try{!o&&i.return&&i.return()}finally{if(n)throw r}}}return t}},{key:"createAnchor",value:function(e,t,o){var n=document.createElement("a");if(e&&(n.href=e),t?n.innerText=t:e&&(n.innerText=e),o){var r=!0,a=!1,i=void 0;try{for(var s,c=o[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var l=s.value;n.classList.add(this.getCssClassWithPrefix(l))}}catch(e){a=!0,i=e}finally{try{!r&&c.return&&c.return()}finally{if(a)throw i}}}return n}},{key:"createDiv",value:function(e){var t=document.createElement("div");if(e){var o=!0,n=!1,r=void 0;try{for(var a,i=e[Symbol.iterator]();!(o=(a=i.next()).done);o=!0){var s=a.value;t.classList.add(this.getCssClassWithPrefix(s))}}catch(e){n=!0,r=e}finally{try{!o&&i.return&&i.return()}finally{if(n)throw r}}}return t}},{key:"createParagraph",value:function(e){var t=document.createElement("p");if(e){var o=!0,n=!1,r=void 0;try{for(var a,i=e[Symbol.iterator]();!(o=(a=i.next()).done);o=!0){var s=a.value;t.classList.add(this.getCssClassWithPrefix(s))}}catch(e){n=!0,r=e}finally{try{!o&&i.return&&i.return()}finally{if(n)throw r}}}return t}},{key:"createSpan",value:function(e){var t=document.createElement("span");if(e){var o=!0,n=!1,r=void 0;try{for(var a,i=e[Symbol.iterator]();!(o=(a=i.next()).done);o=!0){var s=a.value;t.classList.add(this.getCssClassWithPrefix(s))}}catch(e){n=!0,r=e}finally{try{!o&&i.return&&i.return()}finally{if(n)throw r}}}return t}},{key:"createInput",value:function(e){var t=document.createElement("input");if(e){var o=!0,n=!1,r=void 0;try{for(var a,i=e[Symbol.iterator]();!(o=(a=i.next()).done);o=!0){var s=a.value;t.classList.add(this.getCssClassWithPrefix(s))}}catch(e){n=!0,r=e}finally{try{!o&&i.return&&i.return()}finally{if(n)throw r}}}return t}},{key:"createImage",value:function(e,t){var o=document.createElement("img");if(e&&(o.src=e),t){var n=!0,r=!1,a=void 0;try{for(var i,s=t[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var c=i.value;o.classList.add(this.getCssClassWithPrefix(c))}}catch(e){r=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw a}}}return o}},{key:"createAudio",value:function(e,t,o){var n=document.createElement("audio");return e&&(n.src=e),n.autoplay=void 0!==o&&o,t&&n.classList.add(this.getCssClassWithPrefix(t)),n}},{key:"createVideo",value:function(e,t,o){var n=document.createElement("video");return e&&(n.src=e),n.autoplay=void 0!==o&&o,t&&n.classList.add(this.getCssClassWithPrefix(t)),n}},{key:"createHTML",value:function(e){var t=this.createDiv();return t.innerHTML=e,t}},{key:"createStyle",value:function(e){var t=document.createElement("style");return t.type="text/css",t.appendChild(document.createTextNode(e)),t}}]),e}();o.Utils=a},{}],36:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(o,"__esModule",{value:!0}),o.Main=void 0;var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=e("./core/logger"),i=e("./core/utils"),s=e("./components/style/style.component"),c=e("./providers/bots-data-service"),l=e("./components/widget/widget.component"),u=new(o.Main=function(){function e(){n(this,e),this._logger=new a.Logger("Main")}return r(e,[{key:"onLoad",value:function(){var e=this;this._logger.debug("onLoad","load chat widget");var t=new c.BotsDataService,o=new i.Utils(t.config);if(!t.config.useCustomStyle){var n=new s.StyleComponent(o);document.head.appendChild(n.render())}t.init().then(function(){return e.createWidget(o,t.config,t.service)})}},{key:"createWidget",value:function(e,t,o){var n=new l.WidgetComponent(e,t,o);n.appendToElement(document.body),t.isOpen&&n.showChat()}}]),e}());document.addEventListener?document.addEventListener("DOMContentLoaded",u.onLoad.bind(u),!1):window.addEventListener("load",u.onLoad.bind(u),!1)},{"./components/style/style.component":29,"./components/widget/widget.component":30,"./core/logger":33,"./core/utils":35,"./providers/bots-data-service":47}],37:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(o,"__esModule",{value:!0}),o.BotsSDKMessage=void 0;var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=e("../common/payloads/message-payload/message-payload.interface"),i=e("../common/payloads/message-payload/card-message-payload.interface"),s=e("../common/payloads/action-payload/action-payload.interface"),c=e("../common/message-to"),l=e("../common/message-from"),u=e("../common/payloads/attachment-payload.interface"),p=e("../../core/logger"),f=e("./messages/message.interface"),h=e("./messages/actions/action.interface");o.BotsSDKMessage=function(){function e(){n(this,e),this._logger=new p.Logger("BotsSDKMessage")}return r(e,[{key:"toCommonMessage",value:function(){var e=void 0;switch(this.type){case f.BOTS_SDK_PAYLOAD_TYPE.TEXT:e={type:a.PAYLOAD_TYPE.TEXT,text:this.text,actions:this.convertSDKBotActionsToCommon(this.actions)};break;case f.BOTS_SDK_PAYLOAD_TYPE.LIST:case f.BOTS_SDK_PAYLOAD_TYPE.CAROUSEL:var t=[],o=!0,n=!1,r=void 0;try{for(var s,p=this.items[Symbol.iterator]();!(o=(s=p.next()).done);o=!0){var h=s.value;t.push({title:h.title,description:h.description,imageUrl:h.mediaUrl,actions:this.convertSDKBotActionsToCommon(h.actions)})}}catch(e){n=!0,r=e}finally{try{!o&&p.return&&p.return()}finally{if(n)throw r}}e={type:a.PAYLOAD_TYPE.CARD,layout:this.type===f.BOTS_SDK_PAYLOAD_TYPE.LIST?i.LAYOUT.VERTICAL:i.LAYOUT.HORIZONTAL,cards:t,globalActions:this.convertSDKBotActionsToCommon(this.actions)};break;case f.BOTS_SDK_PAYLOAD_TYPE.LOCATION:e={type:a.PAYLOAD_TYPE.LOCATION,location:{title:this.text,longitude:this.coordinates.long,latitude:this.coordinates.lat},actions:this.convertSDKBotActionsToCommon(this.actions)};break;case f.BOTS_SDK_PAYLOAD_TYPE.IMAGE:e={type:a.PAYLOAD_TYPE.ATTACHMENT,attachment:{type:u.ATTACHMENT_TYPE.IMAGE,url:this.mediaUrl},actions:this.convertSDKBotActionsToCommon(this.actions)};break;case f.BOTS_SDK_PAYLOAD_TYPE.FILE:var d=u.ATTACHMENT_TYPE.FILE;["video/quicktime"].indexOf(this.mediaType)>-1?d=u.ATTACHMENT_TYPE.VIDEO:["audio/mpeg"].indexOf(this.mediaType)>-1&&(d=u.ATTACHMENT_TYPE.AUDIO),e={type:a.PAYLOAD_TYPE.ATTACHMENT,attachment:{type:d,url:this.mediaUrl},actions:this.convertSDKBotActionsToCommon(this.actions)};break;default:this._logger.error("This Bots SDK message type is not implemented. ",this)}return this._logger.debug("toCommonMessage",this,e),this.role===f.BOTS_SDK_MESSAGE_ROLE.APP_USER?{to:{type:c.USER_MESSAGE_TYPE.USER,id:""},messagePayload:e}:{from:{type:l.BOT_MESSAGE_TYPE.BOT},body:{messagePayload:e}}}},{key:"convertSDKBotActionsToCommon",value:function(e){var t=[];if(e){var o=!0,n=!1,r=void 0;try{for(var a,i=e[Symbol.iterator]();!(o=(a=i.next()).done);o=!0){var c=a.value,l=void 0;switch(c.type){case h.BOTS_SDK_ACTION_TYPE.POSTBACK:var u=c;l={type:s.ACTION_TYPE.POST_BACK,label:u.text,postback:{payload:u.payload,id:u._id}};break;case h.BOTS_SDK_ACTION_TYPE.LINK:var p=c;l={type:s.ACTION_TYPE.URL,label:p.text,url:p.uri};break;case h.BOTS_SDK_ACTION_TYPE.LOCATION_REQUEST:l={type:s.ACTION_TYPE.LOCATION,label:c.text};break;case h.BOTS_SDK_ACTION_TYPE.REPLY:var f=c;l={type:s.ACTION_TYPE.POST_BACK,label:f.text,postback:{payload:f.payload,id:f._id}};break;default:this._logger.error("Not supported BOTS SDK action. ",c)}l&&t.push(l)}}catch(e){n=!0,r=e}finally{try{!o&&i.return&&i.return()}finally{if(n)throw r}}}return t}}],[{key:"fromCommonMessage",value:function(t){var o=void 0,n=t.messagePayload;switch(n.type){case a.PAYLOAD_TYPE.TEXT:var r=n;o={type:f.BOTS_SDK_PAYLOAD_TYPE.TEXT,text:r.text};break;case a.PAYLOAD_TYPE.LOCATION:var i=n;o={type:f.BOTS_SDK_PAYLOAD_TYPE.LOCATION,coordinates:{long:i.location.longitude,lat:i.location.latitude}}}return Object.assign(new e,o)}}]),e}()},{"../../core/logger":33,"../common/message-from":40,"../common/message-to":41,"../common/payloads/action-payload/action-payload.interface":43,"../common/payloads/attachment-payload.interface":44,"../common/payloads/message-payload/card-message-payload.interface":45,"../common/payloads/message-payload/message-payload.interface":46,"./messages/actions/action.interface":38,"./messages/message.interface":39}],38:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n={POSTBACK:"postback",WEBVIEW:"webview",REPLY:"reply",LOCATION_REQUEST:"locationRequest",SHARE:"share",LINK:"link"};o.BOTS_SDK_ACTION_TYPE=n},{}],39:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n={APP_USER:"appUser",APP_MARKET:"appMaker"};o.BOTS_SDK_MESSAGE_ROLE=n;var r={TEXT:"text",LIST:"list",LOCATION:"location",IMAGE:"image",FILE:"file",CAROUSEL:"carousel"};o.BOTS_SDK_PAYLOAD_TYPE=r},{}],40:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n={BOT:"bot",USER:"user",SYSTEM:"system"};o.BOT_MESSAGE_TYPE=n},{}],41:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n={BOT:"bot",USER:"user"};o.USER_MESSAGE_TYPE=n},{}],42:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.createBotMessage=o.createUserMessage=void 0;var n=e("./message-to");o.createUserMessage=function(e,t){return{to:{type:n.USER_MESSAGE_TYPE.BOT,id:t},messagePayload:e}},o.createBotMessage=function(e,t){return{from:e,body:{messagePayload:t}}}},{"./message-to":41}],43:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n={POST_BACK:"postback",CALL:"call",URL:"url",LOCATION:"location"};o.ACTION_TYPE=n},{}],44:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n={IMAGE:"image",VIDEO:"video",AUDIO:"audio",FILE:"file"};o.ATTACHMENT_TYPE=n},{}],45:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n={HORIZONTAL:"horizontal",VERTICAL:"vertical"};o.LAYOUT=n},{}],46:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n={TEXT:"text",CARD:"card",ATTACHMENT:"attachment",LOCATION:"location",RAW:"raw",POSTBACK:"postback"};o.PAYLOAD_TYPE=n},{}],47:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(o,"__esModule",{value:!0}),o.BotsDataService=void 0;var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=e("./bots-sdk-service"),i=e("./chat-server-service"),s=e("../core/logger"),c=e("../core/settings");o.BotsDataService=function(){function e(){n(this,e),this.logger=new s.Logger("BotsDataService");var t=Object.assign(c.defaultSettings,chatWidgetWebSettings);if(s.Logger.logLevel=t.isDebugMode?s.Logger.LOG_LEVEL.DEBUG:s.Logger.LOG_LEVEL.NONE,s.Logger.appName=t.name,s.Logger.appVersion=t.version,this.logger.debug("Create service with configuration",t),!t.mode)throw Error("The bots config does not contain mode.");if(!(t.mode!==c.MODE.BOTS_SDK||t.appId&&t.sdkUrl))throw Error("The bots config does not contain  one of required properties: appId or sdkUrl.");if(!(t.mode!==c.MODE.CHAT_SERVER||t.uri&&t.userId&&t.channel))throw Error("The bots config does not contain one of required properties: uri, channel, or userId.");this.config=t}return r(e,[{key:"init",value:function(){return this.service=this.config.mode===c.MODE.BOTS_SDK?new a.BotsSDKService(this.config):new i.ChatServerService(this.config),this.service.init()}}]),e}()},{"../core/logger":33,"../core/settings":34,"./bots-sdk-service":48,"./chat-server-service":50}],48:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(o,"__esModule",{value:!0}),o.BotsSDKService=void 0;var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=e("../core/logger"),i=e("../model/bots-sdk/bots-sdk-message"),s=e("../model/common/payloads/message-payload/message-payload.interface");o.BotsSDKService=function(){function e(t){n(this,e),this.config=t,this._logger=new a.Logger("BotsSDKService"),this.onMessage=function(e){}}return r(e,[{key:"init",value:function(){return this.loadSdk().then(this.initSdk.bind(this))}},{key:"initSdk",value:function(){var e=this;return new Promise(function(t,o){var n=e.createHiddenDiv();Bots.on("message",function(t){e._logger.info("a message was added to the conversation",t);var o=Object.assign(new i.BotsSDKMessage,t);e.onMessage(o.toCommonMessage())}),Bots.init({appId:e.config.appId,embedded:!0}).then(function(){e._logger.info("ready"),e.updateUser({givenName:"John",surname:"Snow",email:"john.snow@winterfell.com",properties:{smoochCustomVariable1:"Lord",smoochCustomVariable2:"Commander"}}),t()}).catch(function(e){o(e)}),Bots.render(n)})}},{key:"loadSdk",value:function(){var e=this;return new Promise(function(t,o){var n=void 0,r=void 0,a=void 0,i=[],s=[];window.Bots={init:function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];n=t;var r={then:function(e){return s.push({type:"then",next:e}),r},catch:function(e){return s.push({type:"catch",next:e}),r}};return r},on:function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return i.push(t)},render:function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return r=t},destroy:function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return a=t}},window.__onWebMessengerHostReady__=function(e){if(delete window.__onWebMessengerHostReady__,window.Bots=e,n)for(var t=e.init.apply(e,n),o=0;o<s.length;o++){var c=s[o];t="then"===c.type?t.then(c.next):t.catch(c.next)}r&&e.render.apply(e,r),a&&e.destroy.apply(e,a);for(var l=0;l<i.length;l++)e.on.apply(e,i[l])};var c=new XMLHttpRequest;c.addEventListener("load",function(){try{var e=void 0;if((e="string"==typeof this.response?JSON.parse(this.response):this.response).url){var n=document.createElement("script");n.async=!0,n.src=e.url,n.onload=function(){return t()},document.getElementsByTagName("head")[0].appendChild(n)}}catch(e){o(e)}}),c.open("GET",e.config.sdkUrl+"/loader.json",!0),c.responseType="json",c.send()})}},{key:"createHiddenDiv",value:function(){var e=document.createElement("div");return e.id="chat_widget_web_bots_sdk_ui",e.style.display="none",document.body.appendChild(e),e}},{key:"loadChat",value:function(){for(var e=Bots.getConversation(),t=[],o=0;o<e.messages.length;o++){var n=e.messages[o],r=Object.assign(new i.BotsSDKMessage,n),a=r.toCommonMessage();a&&t.push(a),e.replyActions&&e.replyActions.message._id===n._id&&e.replyActions.actions.length>0&&((a.messagePayload?a.messagePayload:a.body.messagePayload).globalActions=r.convertSDKBotActionsToCommon(e.replyActions.actions))}return Promise.resolve(t)}},{key:"send",value:function(e){if(this._logger.debug("send to channel",e),e.messagePayload.type===s.PAYLOAD_TYPE.POSTBACK){var t=e.messagePayload;t.postback.id&&(this._logger.debug("triggerPostback for action",t.postback.id),Bots.triggerPostback(t.postback.id))}else Bots.sendMessage(i.BotsSDKMessage.fromCommonMessage(e))}},{key:"updateUser",value:function(e){return Bots.updateUser(e).catch(function(e){return console.error(e),e})}},{key:"clear",value:function(){for(var e=Object.keys(localStorage),t=0;t<e.length;t++)"appId"!==e[t]&&localStorage.removeItem(e[t])}}]),e}()},{"../core/logger":33,"../model/bots-sdk/bots-sdk-message":37,"../model/common/payloads/message-payload/message-payload.interface":46}],49:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(o,"__esModule",{value:!0}),o.ChatActions=void 0;var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=e("../model/common/payloads/message-payload/message-payload.interface"),i=e("../model/common/message-from"),s=e("../core/logger"),c=function(){function e(t,o){n(this,e),this.logger=new s.Logger("ChatActions"),this.onMessage=t,this.onClear=o}return r(e,[{key:"process",value:function(e){switch(this.logger.debug("process:",e),e.messagePayload.type){case a.PAYLOAD_TYPE.TEXT:return this.processTextMessage(e);case a.PAYLOAD_TYPE.POSTBACK:return this.processPostbackMessage(e);case a.PAYLOAD_TYPE.LOCATION:return this.processLocationMessage(e);default:return!1}}},{key:"processTextMessage",value:function(e){var t=e.messagePayload;if("@demo"===t.text){var o={type:"text",text:"What is response type to show?",actions:[{type:"postback",label:"Text",postback:"@demo text"},{type:"postback",label:"Vertical Cards",postback:"@demo cards vertical"},{type:"postback",label:"Horizontal Cards",postback:"@demo cards horizontal"},{type:"postback",label:"Video Attachment",postback:"@demo video attachment"},{type:"postback",label:"Audio Attachment",postback:"@demo audio attachment"},{type:"postback",label:"Image Attachment",postback:"@demo image attachment"},{type:"postback",label:"File Attachment",postback:"@demo file attachment"},{type:"postback",label:"Location",postback:"@demo location"},{type:"postback",label:"Raw",postback:"@demo raw"},{type:"postback",label:"Request Location",postback:"@demo request location"}]},n={from:{type:i.BOT_MESSAGE_TYPE.USER},body:{messagePayload:o}};return this.onMessage(n),!0}return"@clear"===t.text&&(this.onClear(),location.reload(),!0)}},{key:"processPostbackMessage",value:function(e){var t=e.messagePayload;if("string"!=typeof t.postback)return!1;var o=void 0;switch(t.postback){case"@demo text":o=[{type:"text",text:"This is text demo",actions:[{type:"postback",label:"Postback",postback:{prop:"value"}},{type:"call",label:"Call",phoneNumber:"123412341234"},{type:"location",label:"Location"},{type:"url",label:"Url",url:"http://www.oracle.com"}],globalActions:[{type:"postback",label:"Postback",postback:{prop:"value"}},{type:"call",label:"Call",phoneNumber:"123412341234"},{type:"location",label:"Location"},{type:"url",label:"Url",url:"http://www.oracle.com"}]}];break;case"@demo cards horizontal":o=[{type:"card",layout:"horizontal",cards:[{title:"Card title",description:"Card description",imageUrl:"http://via.placeholder.com/350x150",url:"http://www.oracle.com",actions:[{type:"postback",label:"Postback",postback:{prop:"value"}},{type:"call",label:"Call",phoneNumber:"123412341234"},{type:"location",label:"Location"},{type:"url",label:"Url",url:"http://www.oracle.com"}]},{title:"Card title",description:"Card description",imageUrl:"http://via.placeholder.com/350x150",url:"http://www.oracle.com",actions:[{type:"postback",label:"Postback",postback:{prop:"value"}},{type:"call",label:"Call",phoneNumber:"123412341234"},{type:"location",label:"Location"},{type:"url",label:"Url",url:"http://www.oracle.com"}]}],globalActions:[{type:"postback",label:"Postback",postback:{prop:"value"}},{type:"call",label:"Call",phoneNumber:"123412341234"},{type:"location",label:"Location"},{type:"url",label:"Url",url:"http://www.oracle.com"}]}];break;case"@demo cards vertical":o=[{type:"card",layout:"vertical",cards:[{title:"Card title",description:"Card description",imageUrl:"http://via.placeholder.com/350x150",url:"http://www.oracle.com",actions:[{type:"postback",label:"Postback",postback:{prop:"value"}},{type:"call",label:"Call",phoneNumber:"123412341234"},{type:"location",label:"Location"},{type:"url",label:"Url",url:"http://www.oracle.com"}]},{title:"Card title",description:"Card description",imageUrl:"http://via.placeholder.com/350x150",url:"http://www.oracle.com",actions:[{type:"postback",label:"Postback",postback:{prop:"value"}},{type:"call",label:"Call",phoneNumber:"123412341234"},{type:"location",label:"Location"},{type:"url",label:"Url",url:"http://www.oracle.com"}]}],globalActions:[{type:"postback",label:"Postback",postback:{prop:"value"}},{type:"call",label:"Call",phoneNumber:"123412341234"},{type:"location",label:"Location"},{type:"url",label:"Url",url:"http://www.oracle.com"}]}];break;case"@demo image attachment":o=[{type:"attachment",attachment:{type:"image",url:"http://via.placeholder.com/350x150"},actions:[{type:"postback",label:"Postback",postback:{prop:"value"}},{type:"call",label:"Call",phoneNumber:"123412341234"},{type:"location",label:"Location"},{type:"url",label:"Url",url:"http://www.oracle.com"}],globalActions:[{type:"postback",label:"Postback",postback:{prop:"value"}},{type:"call",label:"Call",phoneNumber:"123412341234"},{type:"location",label:"Location"},{type:"url",label:"Url",url:"http://www.oracle.com"}]}];break;case"@demo audio attachment":o=[{type:"attachment",attachment:{type:"audio",url:"https://html5tutorial.info/media/vincent.mp3"},actions:[{type:"postback",label:"Postback",postback:{prop:"value"}},{type:"call",label:"Call",phoneNumber:"123412341234"},{type:"location",label:"Location"},{type:"url",label:"Url",url:"http://www.oracle.com"}],globalActions:[{type:"postback",label:"Postback",postback:{prop:"value"}},{type:"call",label:"Call",phoneNumber:"123412341234"},{type:"location",label:"Location"},{type:"url",label:"Url",url:"http://www.oracle.com"}]}];break;case"@demo video attachment":o=[{type:"attachment",attachment:{type:"video",url:"http://clips.vorwaerts-gmbh.de/big_buck_bunny.mp4"},actions:[{type:"postback",label:"Postback",postback:{prop:"value"}},{type:"call",label:"Call",phoneNumber:"123412341234"},{type:"location",label:"Location"},{type:"url",label:"Url",url:"http://www.oracle.com"}],globalActions:[{type:"postback",label:"Postback",postback:{prop:"value"}},{type:"call",label:"Call",phoneNumber:"123412341234"},{type:"location",label:"Location"},{type:"url",label:"Url",url:"http://www.oracle.com"}]}];break;case"@demo file attachment":o=[{type:"attachment",attachment:{type:"file",url:"http://via.placeholder.com/350x150"},actions:[{type:"postback",label:"Postback",postback:{prop:"value"}},{type:"call",label:"Call",phoneNumber:"123412341234"},{type:"location",label:"Location"},{type:"url",label:"Url",url:"http://www.oracle.com"}],globalActions:[{type:"postback",label:"Postback",postback:{prop:"value"}},{type:"call",label:"Call",phoneNumber:"123412341234"},{type:"location",label:"Location"},{type:"url",label:"Url",url:"http://www.oracle.com"}]}];break;case"@demo location":o=[{type:"location",location:{title:"Location title",longitude:-79.388385,latitude:43.6435838}}];break;case"@demo raw":o=[{type:"raw",payload:{property:"value"}}];break;case"@demo request location":o=[{type:"text",text:"Please share your location.",actions:[{type:"location",label:"@Share Location"}]}]}if(o){var n=!0,r=!1,a=void 0;try{for(var s,c=o[Symbol.iterator]();!(n=(s=c.next()).done);n=!0){var l=s.value,u={from:{type:i.BOT_MESSAGE_TYPE.BOT},body:{messagePayload:l}};this.onMessage(u)}}catch(e){r=!0,a=e}finally{try{!n&&c.return&&c.return()}finally{if(r)throw a}}return!0}}},{key:"processLocationMessage",value:function(e){var t=e.messagePayload;if("@demo location"===t.location.title){var o={type:"location",location:{title:"Your location",longitude:t.location.longitude,latitude:t.location.latitude}},n={from:{type:i.BOT_MESSAGE_TYPE.BOT},body:{messagePayload:o}};return this.onMessage(n),!0}return!1}}]),e}();o.ChatActions=c},{"../core/logger":33,"../model/common/message-from":40,"../model/common/payloads/message-payload/message-payload.interface":46}],50:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(o,"__esModule",{value:!0}),o.ChatServerService=void 0;var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=e("../model/common/payloads/message-payload/message-payload.interface"),i=e("../model/common/message"),s=e("./web-socket/reconnecting-web-socket"),c=e("../core/logger");o.ChatServerService=function(){function e(t){n(this,e),this.config=t,this._logger=new c.Logger("ChatServerService"),this.onMessage=function(e){},this._uri=this.config.uri+"?user="+this.config.userId}return r(e,[{key:"init",value:function(){var e=this;return new Promise(function(t){e._ws=new s.ReconnectingWebSocket(e.config.webSocketReconnectInterval,e.config.webSocketTimeoutInterval,e._uri),e._ws.onopen=function(){t(),e._logger.debug("ws.Open")},e._ws.onmessage=e.wsMessage.bind(e),e._ws.onclose=function(){return e._logger.debug("ws.Close")},e._ws.onerror=function(t){return e._logger.error("the socket had an error",t)}})}},{key:"loadChat",value:function(){return Promise.resolve([])}},{key:"send",value:function(e){if(this._logger.debug("send message to chat server",e),this._ws.readyState===this._ws.OPEN)if(this._ws.send(JSON.stringify(e)),e.messagePayload.type===a.PAYLOAD_TYPE.POSTBACK){var t=(0,i.createUserMessage)({type:a.PAYLOAD_TYPE.TEXT,text:e.messagePayload.text},this.config.channel);this.onMessage(t)}else this.onMessage(e);else console.error("Can't send message, websoket not ready",e,this._ws.readyState)}},{key:"wsMessage",value:function(e){this._logger.debug("msg received: ",e.data);var t=JSON.parse(e.data);if(t.error)t=(0,i.createBotMessage)(t.from,{type:a.PAYLOAD_TYPE.TEXT,text:"Error: "+t.error.code+" "+t.error.message});else if(t.body&&(t.body.text||t.body.choices)){var o=(0,i.createBotMessage)(t.from,{type:a.PAYLOAD_TYPE.TEXT,text:t.body.text,actions:[]});if(t.body.choices){var n=!0,r=!1,s=void 0;try{for(var c,l=t.body.choices[Symbol.iterator]();!(n=(c=l.next()).done);n=!0){var u=c.value;o.body.messagePayload.actions.push({type:"postback",label:u,postback:u})}}catch(e){r=!0,s=e}finally{try{!n&&l.return&&l.return()}finally{if(r)throw s}}}t=o}else t.from&&t.to&&delete t.from;this.onMessage(t)}},{key:"clear",value:function(){}}]),e}()},{"../core/logger":33,"../model/common/message":42,"../model/common/payloads/message-payload/message-payload.interface":46,"./web-socket/reconnecting-web-socket":51}],51:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(o,"__esModule",{value:!0}),o.ReconnectingWebSocket=void 0;var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=e("../../core/logger"),i=function(){function e(t,o,r,i){n(this,e),this._timedOut=!1,this._forcedClose=!1,this.onclose=function(e){},this.onerror=function(e){},this.onmessage=function(e){},this.onopen=function(e){},this.onconnecting=function(){},this.logger=new a.Logger("ReconnectingWebSocket"),this.logger.debug("create websocket","reconnectInterval: "+t,"timeoutInterval: "+o,r),this._url=r,this._protocols=i,this._readyState=WebSocket.CONNECTING,this.connect(!1),this._reconnectInterval=t,this._timeoutInterval=o}return r(e,[{key:"connect",value:function(e){var t=this;this._ws=new WebSocket(this._url,this._protocols),this.logger.debug("connect","attempt connect",this._url);var o=setTimeout(function(){t.logger.debug("connection timeout, close socket",t._url),t._timedOut=!0,t._ws.close(),t._timedOut=!1},this._timeoutInterval);this._ws.onopen=function(n){clearTimeout(o),t.logger.debug("onopen",t._url),t._readyState=WebSocket.OPEN,e=!1,t.onopen(n)},this._ws.onclose=function(n){clearTimeout(o),t._ws=null,t._forcedClose?(t._readyState=WebSocket.CLOSED,t.onclose(n)):(t._readyState=WebSocket.CONNECTING,t.onconnecting(),e||t._timedOut||(t.logger.debug("onclose",t._url),t.onclose(n)),setTimeout(function(){t.connect(!0)},t._reconnectInterval))},this._ws.onmessage=function(e){t.logger.debug("onmessage",t._url,e.data),t.onmessage(e)},this._ws.onerror=function(e){t.logger.debug("onerror",t._url,e),t.onerror(e)}}},{key:"close",value:function(e,t){this._ws&&(this._forcedClose=!0,this._ws.close())}},{key:"send",value:function(e){if(this._ws)return this.logger.debug("send",this._url,e),this._ws.send(e);throw"INVALID_STATE_ERR : Pausing to reconnect websocket"}},{key:"addEventListener",value:function(e,t,o){this._ws&&this._ws.addEventListener(e,t,o)}},{key:"dispatchEvent",value:function(e){return!!this._ws&&this._ws.dispatchEvent(e)}},{key:"removeEventListener",value:function(e,t,o){this._ws&&this._ws.removeEventListener(e,t,o)}},{key:"url",get:function(){return this._url}},{key:"protocol",get:function(){return this._ws.protocol}},{key:"bufferedAmount",get:function(){return this._ws.bufferedAmount}},{key:"extensions",get:function(){return this._ws.extensions}},{key:"readyState",get:function(){return this._ws?this._ws.readyState:this._readyState}},{key:"CLOSED",get:function(){return this._ws.CLOSED}},{key:"CLOSING",get:function(){return this._ws.CLOSING}},{key:"CONNECTING",get:function(){return this._ws.CONNECTING}},{key:"OPEN",get:function(){return this._ws.OPEN}},{key:"binaryType",get:function(){return this._ws.binaryType},set:function(e){this._ws.binaryType=e}}]),e}();o.ReconnectingWebSocket=i},{"../../core/logger":33}]},{},[36]);